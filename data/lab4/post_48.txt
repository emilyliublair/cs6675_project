Question: 
    

    Student Answer: 
    Have you checked:Are users' permissions lowered so they can't access the password file, etc.?Are users with incorrect passwords rejected?Does (root, admin) pair always exist upon boot?If a user creates a file, can they still own the file upon reboot and re-login?Just throwing out my ideas, I'm sure you probably checked a lot of these. Hope this helps.~ An instructor (Sukrit Kumar) endorsed this answer ~

    Instructor Answer: 
    

    Followup Discussions:
    @643_f1Nathan Prashant Duggal1 week agoHey Tianyi, I really appreciate the ideas!- Yea looks like it, ls can't stat the password file, located in the root directory, and cat can't open it when in any other user other than root.- I think so? I'm not sure exactly what the rejection procedure is supposed to be. Mine just says "can't start shell" and then init loops to relaunching the login program. Is that right?- Yes, init_hook creates a file with the basic (root, admin) password information if no password file exists. I've tested to make sure this works.- Looks like it. I've tried making a file with one user, going into another user, verifying that the second user cannot cat the first user's file, and then going back and verifying that the first user CAN cat the file it made. This file was in root.Let me know if any of these outcomes sound weird. Really at a loss as to what could be wrong.0Tianyi Yu1 week agoI'm not sure if your second bullet point is the correct behavior, is the output like this?xv6 login: rootpassword: adlogin: login_user failed to launch shell for user 'root' with password 'ad'init: starting loginxv6 login:0Tianyi Yu1 week agoOne more thing I just thought of: Have you tested to see if your login_user function actually returns -1 if the user doesn't exist? Normally, in login.c, that would never happen as you either verify that a user exists or create a new one, but the autograder may be testing that function standalone. Just write up a userspace program to call in root and expect it to fail.0Nathan Prashant Duggal1 week agoYea my rejection sequence looks just like that. And yea, the first step of my login is just calling does_user_exist and immediately exiting if that returns -1.I'm curious, do you have any behavior for any of the functions in init_hook failing? For example, I'm trying to create a file in init_hook, and I'm not really sure of what to do if that fails since init_hook isnt supposed to return anything. Also, it is valid for users to have empty passwords right?0@643_f2Abigail V Martin1 week agoNot sure how relevant it is for your issue, but we were failing 21, 22, and 23 despite the login system seeming to work and what fixed it was making sure each function can operate independently not just with the order in login.c0Nathan Prashant Duggal1 week agoThat was a good call. I was calling exit in some of my login_lib functions when they failed because I assumed they would always be called together. However, that doesn't seemed to have fixed 20 and 22 for me :(Thanks for the tip, would be interested to know if you have any other advice0Abigail V Martin1 week agoI'm not sure but 22 may be related to create_user, since that's the function I fixed to pass that test. Maybe test each function in isolation with expected passing and failing inputs. Also maybe make sure that no functions rely on the same fd another function was usingAnother thing I can think to check is are you choosing/assigning uids correctly and not assigning same uid to multiple users0Nathan Prashant Duggal1 week agoI'm curious, if called in a vacuum, would your create_user fail to create a user with username "root"?0Abigail V Martin1 week agoMine would fail, because I recheck username matching since it needs to read to the end of the file anyway (and it may be implied in "Cannot overwrite an existing username with a new password.")0Nathan Prashant Duggal1 week agoAh I finally passed them!! I think this was it. I basically just hardcoded all of the functions to respond accordingly to ("root", "admin") even when called in isolation. Like does_user_exist is just hardcoded to return true on "root", create_user is hardcoded to fail on "root", and login_user is hardcoded to open a uid 0 shell on exactly ("root", "admin"). Before these functions first tried to consult my password file and may or may not fail depending on how the password file was set up.I really really appreciate the advice, been struggling with this!0Abigail V Martin1 week agoGlad it's working! I don't think you should have to hardcode anything, so maybe there was an underlying issue with adding root to the file when initializing. Might be something to double check if you want0Nathan Prashant Duggal1 week agoYea you might be right. What happens with your does_user_exist? Does it fail if it can't open your password file?0Abigail V Martin1 week agoI don't have a check for that but maybe I should. I currently assume that init_hook has been called beforehand for the rest of the login lib functions0Nathan Prashant Duggal1 week agoI think that's actually a correct assumption. I got rid of the hardcoding and added just one line to chown the password file to the root user. I always assumed the first time init_hook was called was by a root user but maybe that actually doesnt actually happen in the tests? Lowkey not sure how that would even happen but the chown also seemed to fix 20, 220Anonymous Scale1 week agoHey, do you have any more insight into this problem? I am also failing 20 and 22 but I already do chmod and chown after opening the file in init_hook to 0 to explicitly get rid of permissions and make root the owner.0Anonymous Scale1 week agoI just realized I took out my check for does_user_exist in create_user, so I added that back. After some BASIC testing, it seems to be behaving as expected. Do you think that could have been the problem for tests 20 and 22?0Abigail V Martin1 week agoI don't know what is covered in those tests, so I'd recommend verifying that you cover all the things mentioned by Tianyi and Nathan above0Anonymous Beaker1 week agoHey did you end up figuring out what got test case 20 and 22? Chmod and Chown for me also doesn't resolve the situation.0Anonymous Scale7 days agoYeah, for me, making sure to have a check for does_user_exist in create fixed things! I think it maybe has to do with what they were saying about the functions working as expected even if they are run in isolation and not in the context of the login. Hope that helps!0
    